<!DOCTYPE html>
<html>

<head>
  <title>Parallax Effect Example</title>
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
      /* 隱藏水平滾動條，避免視差效果失真 */
    }

    .parallax-container {
      /* width: 100%; */
      height: 100vh;
      /* 設定視差容器的高度為視窗的高度 */
      overflow: hidden;
      /* 隱藏超出容器範圍的內容 */
      position: relative;
      /* 確保視差元素的位置相對於這個容器 */
    }

    .parallax-element {
      width: 100%;
      height: 1500px;
      /* 設定視差元素高度為視差容器的高度，填滿整個容器 */
      background-size: cover;
      /* 背景圖片等比例縮放填滿整個容器 */
      position: absolute;
      /* 設置為絕對位置，使其不佔據文檔流 */
      top: -250.5px;
      left: 0;
      transform: translateZ(0);
      visibility: visible; /* 新版新增，設定視差容器可見 */
  z-index: -100; /* 新版新增，將視差容器堆疊在最底層 */
  overflow: hidden; /* 新版新增，隱藏視差容器內超出範圍的內容 */
    }

    /* .content{
      position: relative;
      z-index: 1;
    } */
  </style>
</head>

<body>
  <!-- 視差容器 -->
  <div class="parallax-container">
    <!-- 視差背景圖片 -->
    <div class="parallax-element" data-parallax="scroll" data-natural-height="1500" data-bleed="0.5"
      data-image-src="https://picsum.photos/id/237/1440/1500"></div>
  </div>

  <!-- 其他內容 -->
  <div class="content">
    <!-- 這裡放置網頁內容 -->
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>
    <p>a</p>

  </div>

  <script src="./js/jquery_3.7.0_jquery.min.js"></script>
  <script src="./js/parallax.min.js"></script>
  <script>
    // 初始化 Parallax 效果
    $('.parallax-element').parallax();
    // $('.parallax-element').css('height',document.body.scrollHeight+"px")
    console.log(document.body.scrollHeight);
    $(window).on('scroll', function () {
      let scrollPositionY = $(this).scrollTop();
      let parallaxElement = $('.parallax-element');
      let parallaxContainerHeight = $('.parallax-container').outerHeight();
      let parallaxElementHeight = parallaxElement.outerHeight();
      let parallaxElementTop = -250.5; // 初始位置設定為向上位移一部分，可以根據需求調整

      // 計算視差元素的移動距離，根據滾動卷軸的位置和速度來調整
      let translateY = (scrollPositionY / (parallaxContainerHeight + parallaxElementHeight)) * parallaxElementHeight + parallaxElementTop;

      // 使用 CSS 的 transform 屬性來設定視差元素的位置
      parallaxElement.css('transform', 'translateY(' + translateY + 'px)');
    });
  </script>
</body>

</html>